
<%- include("partials/head") %>

<% let backgroundImage = animebanner[0] && animebanner[0].attributes.coverImage ? 
                     animebanner[0].attributes.coverImage.original : 
                     animeEz.images.jpg.large_image_url; 
    let useRepeatBackground = backgroundImage === animeEz.images.jpg.large_image_url;                
                    %>

<!-- <div class="background <%= useRepeatBackground ? 'repeat-bg' : '' %>" 
     style="background-image: url('<%= backgroundImage %>');">
</div> if i want repeat background for non backgrounds-->

<div class="background " 
    style="background-image: url('<%= backgroundImage %>');">
</div>



<div id="root">
    <div class="pageResult">
        <%- include("partials/header") %>
        <% if (animeEz) { %>

        <div class="row rowstyle" style="max-width: 900px; margin: 0px auto 20px; padding: 0px 20px 20px;">
            <div class=resultbcolor>
            <div class="row"> 
                <div style="display: flex; margin-bottom: 20px; flex-direction: column;" class="col-md-12">
                    <div class="banner-container">
                    <div class="banner" style="background-image: url('<%= backgroundImage %>'); ">
                    
                    <div class="blur-container">
                        <div class="blurbanner"></div>
                            </div>
                        </div></div>
                            <div class="blur-details">
                                <img class="animeCover" src="<%= animeEz.images.jpg.large_image_url %>" alt="<%= animeEz.title %>">
                                    <div class="fulldetails-container">
                                        <div class="details-container">
                                            <div class="text-container">
                                                <h3 ><%= animeEz.title %></h3>
                                                <h5><%= animeEz.title_english %></h3>
                                                <p ><strong> Aired: </strong><%= animeEz.aired.string || "I Don't Know" %></p>
                                                <p> <strong>  <%= animeEz.episodes || "Unknown" %> Episodes</strong></p>
                                                <p> <strong> Genres:</strong> <%= animeEz.genres.length ? animeEz.genres.map(g => g.name).join(", ") : "I Don't Know" %></p>
                                            </div>
                                             <div class="divider" ></div>
                                                <div class="ratingContainer">
                                                    <div class="ratingDisplay">
                                                        <p class="scorecolor"><strong >Score</strong> </p> 
                                                        <p class="scorenumber"><%= animeEz.rank ? animeEz.score : "Not Rated" %></p>
                                                    </div>
                                                    <div class="rankedDisplay">
                                                        <p class="mb-0"><strong>Ranked</strong></p>
                                                            <p class="fw-bold rankednumber"> <%= animeEz.rank ? "#" + animeEz.rank.toLocaleString() : "Too Good to be Ranked" %></p>
                                            </div> </div>
                                        </div>
                                    </div>  
                                </div>                    
                            </div>
                        </div>
            <div class="row">
                    <div class="well" >     
                                    <h3 class="trailerBb"><strong> Trailer</strong></h3>
                                    <div class="video-container" style="margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center;" >
                                        <% if (animeEz.trailer && animeEz.trailer.embed_url) { %>
                                        <iframe 
                                        width="100%" 
                                        height="400"
                                            src="<%= animeEz.trailer.embed_url %>autoplay=0" 
                                            frameborder="0" 
                                            allowfullscreen 
                                            title="trailer"
                                            allow ="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
                                        </iframe>
                                   
                                <% } else { %>
                                    <p>No trailer available :( </p>
                                <% } %> 
                            </div> 
                        </div>
                </div>               
            <div>
                <div>
                        <h3 class="trailerBb"><strong>Synopsis</strong> </h3>
                     <p style="font-weight: 500; text-align: justify;"> <%= animeEz.synopsis || "No synopsis available." %></p>
                </div>
            </div>

            <ul class="list-group">
                <li class="list-group-item" > <strong>English Title:</strong> <%= animeEz.title_english %> </li>
                <li class="list-group-item" > <strong>Japanese Title:</strong><%= animeEz.title_japanese %> </li>
                <li class="list-group-item" > <strong>Score:</strong> <%= animeEz.score ? animeEz.score + " (Scored by " + animeEz.scored_by.toLocaleString() + " People)" : "Not Scored" %> </li>
                <li class="list-group-item" > <strong>Ranked: </strong> <%= animeEz.rank ? "#" + animeEz.rank.toLocaleString() : "Too Good to be Ranked" %> </li>                
                <li class="list-group-item" > <strong>Genre:</strong> <%= animeEz.genres.length ? animeEz.genres.map(g => g.name).join(", ") : "I Don't Know" %> </li>
                <li class="list-group-item" > <strong>Themes:</strong> <%= animeEz.themes.length ? animeEz.themes.map(t => t.name).join(", ") : "I Don't Know" %> </li>
                <li class="list-group-item" > <strong>Demographics:</strong> <%= animeEz.demographics.length ? animeEz.demographics.map(d => d.name).join(", ") : "I Don't Know" %> </li>
                <li class="list-group-item" > <strong>Type:</strong> <%= animeEz.type %> </li>
                <li class="list-group-item" > <strong>Episodes:</strong> <%= animeEz.episodes || "Unknown" %> </li>
                <li class="list-group-item" > <strong>Duration:</strong>  <%= animeEz.duration || "Who Knows" %> </li>
                <li class="list-group-item" > <strong>Rating:</strong> <%= animeEz.rating || "Who Knows" %> </li>       
                <li class="list-group-item" > <strong>Source:</strong> <%= animeEz.source || "No Source" %> </li>
                <li class="list-group-item" > <strong>Status:</strong> <%= animeEz.status || "I Don't Know" %> </li>
                <li class="list-group-item" > <strong>Premiered:</strong> <%= animeEz.season && animeEz.year ? animeEz.season.charAt(0).toUpperCase() + animeEz.season.slice(1) + " " + animeEz.year : "I Don't Know" %> </li>
                <li class="list-group-item" > <strong>Aired:</strong> <%= animeEz.aired.string || "I Don't Know" %> </li>
                <li class="list-group-item" > <strong>Popularity:</strong>  <%= animeEz.popularity ? "#" + animeEz.popularity.toLocaleString() : "idk" %> </li>
                <li class="list-group-item" > <strong>Members:</strong> <%= animeEz.members ? animeEz.members.toLocaleString() : "None" %> </li>
                <li class="list-group-item" > <strong>Producers: </strong> <%= animeEz.producers.length ? animeEz.producers.map(p => p.name).join(", ") : "They must be Great People" %> </li>
                <li class="list-group-item" > <strong>Studios:</strong>    <%= animeEz.studios.length ? animeEz.studios.map(s => s.name).join(", ") : "None" %> </li>
            </ul>

<% } else { %>
    <p>No anime found. Try again!</p>
<% } %>

<div class="allandkirby">
    <!-- MyAnimeList Link -->
    <div class="mal" style="width: 280px; text-align: center;">
        <a href="<%= animeEz.url %>" target="_blank" style="text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 10px;" >
            <span class="kirbytextsize">More Info At MyAnimeList</span>
            <img src="/images/mal.png" width="40px" style="border-radius: 50%;" alt="myanimelist" class="imgbt">
        </a>
    </div>

    <!-- Divider -->
    <div class="divider boxshadow" ></div>

    <!-- Resubmit Button -->
    <div style="width: 280px; text-align: center;">
        <button id="resubmitBtn" style="background: none; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; color: #F99ABD; ">
            <span class="kirbytextsize">Get <span style="color: #AD1A35;"> Another</span> Result</span>
            <img src="/images/3.png" width="60px" padding-bottom="10px" alt="emirusit" class="kirbyimgbt">
        </button>
    </div>
    
    <!-- Divider -->
    <div class="divider boxshadow" ></div>

    <!-- Home Page Link -->
    <div style="width: 280px; text-align: center;">
        <a href="/" style="text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 10px; color: black;">
            <span class="kirbytextsize">Go back to the<span style="color: white;"> Home</span> Page</span>
            <img src="/images/house-heart-fill.svg" width="40px" alt="homeicon"class="imgbt">
        </a>
    </div>
</div>
</div>

            </div>
        </div>
    </div>
    

</div>

</div>   
<footer style="display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px 0; width: 100%; background-color: #222; color: white;">
        <p style="margin-bottom: 10px; font-weight: 200;">&copy; <span id="current-year"></span> rANdIME. All Rights Reserved.</p>
        
        <nav style="display: flex; justify-content: center; align-items: center; gap: 15px;">
            <a  href="/" class="bottomhalf" style="color: #FF6680; text-decoration: none; font-size: 20px; margin:0px 15px">rANdIME</a>
            <a href="/about" style="color: #6fd1ad; text-decoration: none; font-size: 16px;margin:0px 15px">About/Instructions</a>
            <a href="/about" style="color: #676de2; text-decoration: none; font-size: 16px;margin:0px 15px">Contact</a>
            
            <!-- Random Anime Button aligned with other links -->
            <form action="/results" method="POST" style="display: inline;">
                <button type="submit" name="randomButton" value="true" class="btn btn-secondary btn-lg randombottom" style="background: none; border: none; color: #c2d62c; font-size: 16px; padding: 0; cursor: pointer;">
                    Random
                </button>
            </form>
        </nav>
    </footer>

<%- include("partials/footer") %> 